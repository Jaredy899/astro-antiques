---
// Export function for use in other components
export function getStoreStatus() {
  // Manual override - set to 'open', 'closed', or null for automatic
  const MANUAL_OVERRIDE = null as 'open' | 'closed' | null; // Change this to 'open' or 'closed' to override automatic status
  
  // Check for manual override first
  if (MANUAL_OVERRIDE === 'open') {
    return {
      isOpen: true,
      statusText: 'OPEN',
      statusClass: 'text-green-600 dark:text-green-400',
      hoursText: 'Mon-Sat 10-6, Sun 1-4'
    };
  }
  
  if (MANUAL_OVERRIDE === 'closed') {
    return {
      isOpen: false,
      statusText: 'CLOSED',
      statusClass: 'text-red-600 dark:text-red-400',
      hoursText: 'Mon-Sat 10-6, Sun 1-4'
    };
  }
  
  // Get current time in Eastern Time (store's timezone)
  const now = new Date();
  const easternTime = new Date(now.toLocaleString("en-US", {timeZone: "America/New_York"}));
  const currentDay = easternTime.getDay(); // 0 = Sunday, 1 = Monday, etc.
  const currentHour = easternTime.getHours();
  const currentYear = easternTime.getFullYear();
  const currentMonth = easternTime.getMonth(); // 0-based (0 = January)
  const currentDate = easternTime.getDate();
  
  // Function to calculate Easter Sunday for a given year
  function getEasterDate(year: number) {
    const a = year % 19;
    const b = Math.floor(year / 100);
    const c = year % 100;
    const d = Math.floor(b / 4);
    const e = b % 4;
    const f = Math.floor((b + 8) / 25);
    const g = Math.floor((b - f + 1) / 3);
    const h = (19 * a + b - d - g + 15) % 30;
    const i = Math.floor(c / 4);
    const k = c % 4;
    const l = (32 + 2 * e + 2 * i - h - k) % 7;
    const m = Math.floor((a + 11 * h + 22 * l) / 451);
    const n = Math.floor((h + l - 7 * m + 114) / 31);
    const p = (h + l - 7 * m + 114) % 31;
    return { month: n - 1, day: p + 1 }; // month is 0-based
  }
  
  // Function to get Thanksgiving date (4th Thursday of November)
  function getThanksgivingDate(year: number) {
    const november = new Date(year, 10, 1); // November 1st
    const firstDay = november.getDay(); // Day of week for Nov 1st
    const firstThursday = 1 + (4 - firstDay + 7) % 7; // First Thursday
    const fourthThursday = firstThursday + 21; // Add 3 weeks
    return fourthThursday;
  }
  
  // Check if today is a holiday when store is closed
  const easter = getEasterDate(currentYear);
  const thanksgiving = getThanksgivingDate(currentYear);
  
  const isHoliday = (
    // New Year's Day
    (currentMonth === 0 && currentDate === 1) ||
    // Easter Sunday
    (currentMonth === easter.month && currentDate === easter.day) ||
    // Independence Day
    (currentMonth === 6 && currentDate === 4) ||
    // Thanksgiving Day
    (currentMonth === 10 && currentDate === thanksgiving) ||
    // Christmas Eve
    (currentMonth === 11 && currentDate === 24) ||
    // Christmas Day
    (currentMonth === 11 && currentDate === 25)
  );
  
  // If it's a holiday, store is closed
  if (isHoliday) {
    return {
      isOpen: false,
      statusText: 'CLOSED',
      statusClass: 'text-red-600 dark:text-red-400',
      hoursText: 'Mon-Sat 10-6, Sun 1-4'
    };
  }
  
  // Regular store hours: Mon-Sat 10-6, Sun 1-4
  let isOpen = false;
  if (currentDay === 0) { // Sunday
    isOpen = currentHour >= 13 && currentHour < 16; // 1 PM - 4 PM
  } else if (currentDay >= 1 && currentDay <= 6) { // Monday-Saturday
    isOpen = currentHour >= 10 && currentHour < 18; // 10 AM - 6 PM
  }
  
  return {
    isOpen: isOpen,
    statusText: isOpen ? 'OPEN' : 'CLOSED',
    statusClass: isOpen 
      ? 'text-green-600 dark:text-green-400' 
      : 'text-red-600 dark:text-red-400',
    hoursText: 'Mon-Sat 10-6, Sun 1-4'
  };
}
---

<!-- This component doesn't render anything, it's just for exporting the function --> 